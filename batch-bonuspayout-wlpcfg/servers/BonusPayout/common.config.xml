<server description="Common Configuration for Batch Multi-Server Environment">

    <library id="DerbyLib">
        <fileset dir="${shared.resource.dir}/derbyclient" includes="derbyclient.jar"/>
    </library>

    <dataSource id="batchDB" jndiName="jdbc/batch" type="javax.sql.XADataSource">
        <jdbcDriver libraryRef="DerbyLib"/>
        <!-- The 'databaseName' is set in bootstrap.properties -->
        <properties.derby.client createDatabase="create" databaseName="BATCHDB" serverName="${env.DB_HOST}" user="user" password="pass"  portNumber="${env.DB_PORT}"/>
    </dataSource>

    <databaseStore id="BatchDatabaseStore" datasourceRef="batchDB" schema="JBATCH" tablePrefix=""/>


<jmsConnectionFactory id="batchCF" jndiName="jms/batch/batchCF">
    <properties.wasJms remoteServerAddress="${env.MESSAGE_HOST}:${env.MESSAGE_PORT}:BootstrapBasicMessaging"/>
</jmsConnectionFactory>

<jmsQueue id="batchQ" jndiName="jms/batch/batchQ">
    <properties.wasJms deliveryMode="Persistent" queueName="batchQ" readAhead="AsConnection" timeToLive="0"/>
</jmsQueue>

<jmsActivationSpec id="batchAS">
    <properties.wasJms messageSelector="com_ibm_ws_batch_work_type = 'Job'"
                       destinationRef="batchQ"
                       destinationType="javax.jms.Queue"
                       remoteServerAddress="${env.MESSAGE_HOST}:${env.MESSAGE_PORT}:BootstrapBasicMessaging" />
</jmsActivationSpec>


</server>
